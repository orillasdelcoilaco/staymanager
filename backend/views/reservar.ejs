<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Completar Reserva | <%= empresa.nombre %></title>
    <link rel="stylesheet" href="/public/css/website.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <%- include('partials/header') %>

    <main class="container py-12">
        <h1 class="text-3xl font-bold text-gray-900 mb-8">Completa tu Reserva</h1>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="md:col-span-2">
                <form action="/reservar" method="POST" class="bg-white p-8 rounded-lg shadow-lg space-y-6">
                    <h2 class="text-xl font-bold">Ingresa tus datos de contacto</h2>
                    <input type="hidden" name="propiedadId" value="<%= propiedad.id %>">
                    <input type="hidden" name="fechaLlegada" value="<%= query.fechaLlegada %>">
                    <input type="hidden" name="fechaSalida" value="<%= query.fechaSalida %>">
                    <input type="hidden" name="personas" value="<%= query.personas %>">
                    <input type="hidden" name="noches" value="<%= query.noches %>">
                    <input type="hidden" name="precioFinal" value="<%= query.precioFinal %>">

                    <div>
                        <label for="nombre" class="block text-sm font-medium text-gray-700">Nombre Completo</label>
                        <input type="text" id="nombre" name="nombre" class="form-input mt-1" required>
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" id="email" name="email" class="form-input mt-1" required>
                    </div>
                    <div>
                        <label for="telefono" class="block text-sm font-medium text-gray-700">Teléfono</label>
                        <input type="tel" id="telefono" name="telefono" class="form-input mt-1" required>
                    </div>
                    <button type="submit" class="btn w-full">Confirmar y Reservar</button>
                </form>
            </div>
            <div class="md:col-span-1">
                <div class="bg-white p-6 rounded-lg shadow-lg sticky top-8">
                    <h3 class="text-lg font-bold border-b pb-2">Resumen de tu reserva</h3>
                    <img src="<%= propiedad.linkFotos || 'https://via.placeholder.com/400x300.png?text=Imagen+no+disponible' %>" class="rounded-md my-4 w-full h-40 object-cover">
                    <h4 class="font-bold"><%= propiedad.nombre %></h4>
                    <p class="text-sm text-gray-600"><%= query.personas %> huéspedes</p>
                    <div class="text-sm mt-4 space-y-2 border-t pt-4">
                        <div class="flex justify-between"><span>Llegada:</span> <strong><%= new Date(query.fechaLlegada + 'T00:00:00Z').toLocaleDateString('es-CL', { timeZone: 'UTC' }) %></strong></div>
                        <div class="flex justify-between"><span>Salida:</span> <strong><%= new Date(query.fechaSalida + 'T00:00:00Z').toLocaleDateString('es-CL', { timeZone: 'UTC' }) %></strong></div>
                        <div class="flex justify-between"><span>Noches:</span> <strong><%= query.noches %></strong></div>
                    </div>
                    <div class="flex justify-between text-xl font-bold mt-4 border-t pt-4">
                        <span>Total:</span>
                        <span>$<%= parseInt(query.precioFinal).toLocaleString('es-CL') %></span>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <%- include('partials/footer') %>
</body>
</html>