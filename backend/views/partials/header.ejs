<%- /* backend/views/partials/header.ejs */ %>
<header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="container py-3 flex items-center justify-between">
        <a href="/" class="flex items-center space-x-3">
            <% if (empresa.websiteSettings?.theme?.logoUrl) { %>
                <img src="<%= empresa.websiteSettings.theme.logoUrl %>" alt="<%= empresa.nombre %> Logo" class="h-9 max-w-[150px] object-contain">
            <% } %>
            <span class="text-xl md:text-2xl font-bold text-gray-900 truncate">
                <%= empresa.nombre %>
            </span>
        </a>
        <nav class="hidden sm:flex items-center space-x-4">
            <a href="/#propiedades" class="text-gray-600 hover:text-indigo-600 font-semibold transition text-sm">Ver Propiedades</a>
            
            <%# --- INICIO BOTÓN WHATSAPP HEADER --- %>
            <%# Ocultar si estamos en la página de una propiedad (paginaPropiedad se define en propiedad.ejs) %>
            <% if (empresa.contactoTelefono && empresa.contactoNombre && !locals.paginaPropiedad) { %>
                <% 
                    const telefonoLimpio = empresa.contactoTelefono.replace(/\D/g, '');
                    const nombreAnfitrion = empresa.contactoNombre.split(' ')[0];
                    const mensajeGenerico = `Hola ${nombreAnfitrion}, necesito ayuda con una reserva.`;
                    const whatsappUrl = `https://wa.me/${telefonoLimpio}?text=${encodeURIComponent(mensajeGenerico)}`;
                %>
                <a href="<%= whatsappUrl %>" target="_blank" class="btn-whatsapp">
                    <i class="fa-brands fa-whatsapp w-5 h-5 mr-2 text-white"></i>
                    Hola, soy <%= nombreAnfitrion %>, ¿te ayudo?
                </a>
            <% } %>
            <%# --- FIN BOTÓN WHATSAPP HEADER --- %>
        </nav>
        
        <%# --- Botón Móvil --- %>
        <div class="sm:hidden">
             <% if (empresa.contactoTelefono && !locals.paginaPropiedad) { %>
                <% 
                    const telefonoLimpio = empresa.contactoTelefono.replace(/\D/g, '');
                    const nombreAnfitrion = (empresa.contactoNombre || 'Anfitrión').split(' ')[0];
                    const mensajeGenerico = `Hola ${nombreAnfitrion}, necesito ayuda con una reserva.`;
                    const whatsappUrl = `https://wa.me/${telefonoLimpio}?text=${encodeURIComponent(mensajeGenerico)}`;
                %>
                <a href="<%= whatsappUrl %>" target="_blank" class="btn-whatsapp p-2">
                    <i class="fa-brands fa-whatsapp w-5 h-5 text-white m-0"></i>
                </a>
             <% } %>
        </div>
    </div>
</header>